clear
close all


%% Setting up the grid
dx = 1; %dx = dy
Nx = 50;
Ny = 30;

u_grid_nopadding = zeros(Ny,Nx);
v_grid_nopadding = zeros(Ny,Nx);
h_grid_nopadding = zeros(Ny,Nx);

%Apply initial condition
%u and v initialsed at zero
for x = 1:Nx
    h_grid_nopadding(:,x) = 10 + exp(-(x-50)^2/25);
end


%Padding with the boundary conditions
stencil_length = 7;
u_grid_padded = applyPeriodicBcs(u_grid_nopadding,stencil_length);
v_grid_padded = applyPeriodicBcs(v_grid_nopadding,stencil_length);
h_grid_padded = applyPeriodicBcs(h_grid_nopadding,stencil_length);

%Calculating ks

%solving system in time


%plotting
X = zeros(Ny,Nx)
for x = 1:Nx
    X(:,x) = x;
end
Y = zeros(Ny,Nx)
for y = 1:Ny
    Y(y,:) = y;
end
figure()
plot3(X,Y,h_grid_nopadding)

%plotting padded grid
X_pad = zeros(Ny+6,Nx+6)
for x = 1:Nx
    X_pad(:,x) = x;
end
Y_pad = zeros(Ny+6,Nx+6)
for y = 1:Ny
    Y_pad(y,:) = y;
end
figure()
plot3(X_pad,Y_pad,h_grid_padded)


%% Functions
function grid_padded = applyPeriodicBcs(grid_nopadding,stencil_length)

    pad = (stencil_length-1)/2;

    [Ny,Nx] = size(grid_nopadding);
    Nx_padded = Nx + pad * 2;
    Ny_padded = Ny + pad * 2;

    grid_padded = zeros(Ny_padded,Nx_padded);
    
    grid_padded(pad:(end-1)-(pad),pad:(end-1)-(pad)) = grid_nopadding;

    %top_rows
    grid_padded(1:pad+1,pad:Ny-pad) = grid_nopadding(Ny-pad:Ny,:);

    %bottom rows
    grid_padded(Ny-pad:Ny,pad:Ny-pad) = grid_nopadding(1:pad,:);

    %left columns
    grid_padded(pad+1:end-(pad),1:pad) = grid_nopadding(:,end-(pad-1):end);

    %right columns
    grid_padded(pad+1:end-(pad),end-(pad-1):end) = grid_nopadding(:,1:pad);

end